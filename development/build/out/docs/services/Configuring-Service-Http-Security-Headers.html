<hr>
<h2>
<a id="layout-defaulttitle-cas---configuring-service-http-security-headerscategory-services" class="anchor" href="#layout-defaulttitle-cas---configuring-service-http-security-headerscategory-services" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Configuring Service HTTP Security Headers<br>
category: Services</h2>
<h1>
<a id="service-http-security-headers" class="anchor" href="#service-http-security-headers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Service HTTP Security Headers</h1>
<p>CAS has ability to control, on a per-service basis, whether certain security-related HTTP headers should be injected into the response. While headers are typically enabled and defined globally as part of the <a href="../planning/Security-Guide.html#cas-security-filter">CAS Security Filter</a>, the strategy described here allows one to disable/enable the injection of these headers for certain applications and service requests and override the global defaults.</p>
<h2>
<a id="http-headers" class="anchor" href="#http-headers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>HTTP Headers</h2>
<p>Supported HTTP headers in form of service properties are:</p>
<table>
<thead>
<tr>
<th>Header</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>httpHeaderEnableCacheControl</code></td>
<td>Insert <code>Cache-Control</code> headers into the response for this service.</td>
</tr>
<tr>
<td><code>httpHeaderEnableXContentOptions</code></td>
<td>Insert <code>X-Content-Type-Options</code> headers into the response for this service.</td>
</tr>
<tr>
<td><code>httpHeaderEnableStrictTransportSecurity</code></td>
<td>Insert <code>Strict-Transport-Security</code> headers into the response for this service.</td>
</tr>
<tr>
<td><code>httpHeaderEnableXFrameOptions</code></td>
<td>Insert <code>X-Frame-Options</code> headers into the response for this service.</td>
</tr>
<tr>
<td><code>httpHeaderEnableContentSecurityPolicy</code></td>
<td>Insert <code>Content-Security-Policy</code> headers into the response for this service.</td>
</tr>
<tr>
<td><code>httpHeaderEnableXSSProtection</code></td>
<td>Insert <code>X-XSS-Protection</code> headers into the response for this service.</td>
</tr>
<tr>
<td><code>httpHeaderXFrameOptions</code></td>
<td>Override the <code>X-Frame-Options</code> header of the response for this service.</td>
</tr>
</tbody>
</table>
<p>The headers values are picked up from CAS properties. See <a href="../configuration/Configuration-Properties.html#http-web-requests">this guide</a> for relevant settings.</p>
<p>A sample JSON file follows:</p>
<pre lang="json"><code>{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "^https://.+",
  "name" : "sample service",
  "id" : 100,
  "properties" : {
    "@class" : "java.util.HashMap",
    "httpHeaderEnableXContentOptions" : {
      "@class" : "org.apereo.cas.services.DefaultRegisteredServiceProperty",
      "values" : [ "java.util.HashSet", [ "true" ] ]
    }
  }
}
</code></pre>
<h2>
<a id="cors-policies" class="anchor" href="#cors-policies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CORS Policies</h2>
<p>Cross-origin resource sharing (CORS) policies can also be defined per application in form of service properties. The<br>
following properties are supported:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>corsAllowCredentials</code></td>
<td>Whether user credentials are supported.</td>
</tr>
<tr>
<td><code>corsMaxAge</code></td>
<td>Configure how long, as a duration, the response from a pre-flight request can be cached by clients.</td>
</tr>
<tr>
<td><code>corsAllowedOrigins</code></td>
<td>Set the origins to allow. The special value <code>*</code> allows all domains.</td>
</tr>
<tr>
<td><code>corsAllowedMethods</code></td>
<td>Set the HTTP methods to allow, e.g. <code>GET</code>, etc. The special value <code>*</code> allows all methods.</td>
</tr>
<tr>
<td><code>corsAllowedHeaders</code></td>
<td>Set the list of headers that a pre-flight request can list as allowed for use during an actual request.</td>
</tr>
<tr>
<td>The special value <code>*</code> allows actual requests to send any header.</td>
<td></td>
</tr>
<tr>
<td><code>corsExposedHeaders</code></td>
<td>List of response headers that a response might have and can be exposed. The special value <code>*</code> allows all headers to be exposed for non-credentialed requests.</td>
</tr>
</tbody>
</table>
<p>A sample JSON file follows:</p>
<pre lang="json"><code>{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "^https://.+",
  "name" : "sample service",
  "id" : 100,
  "properties" : {
    "@class" : "java.util.HashMap",
    "corsMaxAge" : {
      "@class" : "org.apereo.cas.services.DefaultRegisteredServiceProperty",
      "values" : [ "java.util.HashSet", [ "1000" ] ]
    }
  }
}
</code></pre>