<hr>
<h2>
<a id="layout-defaulttitle-cas---eureka-service-discoverycategory-high-availability" class="anchor" href="#layout-defaulttitle-cas---eureka-service-discoverycategory-high-availability" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Eureka Service Discovery<br>
category: High Availability</h2>
<p>{% include variables.html %}</p>
<h1>
<a id="eureka-server-discovery-service" class="anchor" href="#eureka-server-discovery-service" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Eureka Server Discovery Service</h1>
<p><a href="https://github.com/Netflix/eureka">Eureka</a> is a REST-based service that is primarily<br>
used for locating services for the purpose of load balancing and failover of middle-tier servers. Eureka provides both a discovery server and also support for clients which would be the individual CAS servers themselves in the pool. The server can be configured and deployed to be highly available, with each server replicating state about the registered services to the others.</p>
<p>CAS provides a Eureka-enabled service discovery server that is based on <a href="http://cloud.spring.io/spring-cloud-netflix">Spring Cloud Netflix</a> and bootstrapped via <a href="http://cloud.spring.io/spring-cloud-static/spring-cloud.html">Spring Cloud</a>.</p>
<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h3>
<ul>
<li>To run the Eureka discovery server, please <a href="https://github.com/apereo/cas-discoveryserver-overlay">use this WAR overlay</a>.</li>
<li>Look for a suitable and relevant ready-made Docker image via <code>docker search eureka</code>.</li>
</ul>
<p>When deployed the following URLs become available:</p>
<table>
<thead>
<tr>
<th>URL</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/</code></td>
<td>Home page listing service registrations.</td>
</tr>
<tr>
<td><code>/eureka/apps</code></td>
<td>Raw registration metadata.</td>
</tr>
</tbody>
</table>
<h3>
<a id="high-availability-mode" class="anchor" href="#high-availability-mode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>High Availability Mode</h3>
<p>You always want to make sure the discovery server is run in high-availability mode. One option is to ensure each individual Eureka server is peer aware. See <a href="http://cloud.spring.io/spring-cloud-static/spring-cloud.html#_peer_awareness">this guide</a> to learn how to manage that.</p>
<h2>
<a id="cas-discovery-service-clients" class="anchor" href="#cas-discovery-service-clients" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CAS Discovery Service Clients</h2>
<p>Each individual CAS server is given the ability to auto-register itself with the discovery server, provided configuration is made available to instruct the CAS server how to locate and connect to the discover server service.</p>
<p>Support is added by including the following dependency in the WAR overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-eureka-client" %}</p>
<p>To see the relevant list of CAS properties,<br>
please <a href="../configuration/Configuration-Properties.html#eureka-service-discovery">review this guide</a>.</p>
<h3>
<a id="authentication" class="anchor" href="#authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authentication</h3>
<p>Support for HTTP basic authentication will be automatically added if one of Eureka server URLs in the configuration has credentials embedded in it (curl style, like <code>http://user:password@localhost:8761/eureka</code>).</p>
<h3>
<a id="troubleshooting" class="anchor" href="#troubleshooting" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Troubleshooting</h3>
<p>To enable additional logging, configure the log4j configuration file to add the following levels:</p>
<pre lang="xml"><code>&lt;Logger name="org.springframework.cloud" level="debug" additivity="false"&gt;
  &lt;AppenderRef ref="casConsole"/&gt;
  &lt;AppenderRef ref="casFile"/&gt;
&lt;/Logger&gt;
&lt;Logger name="com.netflix" level="debug" additivity="false"&gt;
    &lt;AppenderRef ref="casConsole"/&gt;
    &lt;AppenderRef ref="casFile"/&gt;
&lt;/Logger&gt;
</code></pre>