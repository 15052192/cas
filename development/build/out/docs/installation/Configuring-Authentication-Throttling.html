<hr>
<h2>
<a id="layout-defaulttitle-cas---configuring-authentication-throttlingcategory-authentication" class="anchor" href="#layout-defaulttitle-cas---configuring-authentication-throttlingcategory-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Configuring Authentication Throttling<br>
category: Authentication</h2>
<h1>
<a id="throttling-authentication-attempts" class="anchor" href="#throttling-authentication-attempts" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Throttling Authentication Attempts</h1>
<h2>
<a id="capacity-throttling" class="anchor" href="#capacity-throttling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Capacity Throttling</h2>
<p>CAS is able to support request rate-limiting based on the token-bucket algorithm. This means that authentication requests that reach a certain configurable<br>
capacity within a time window may either be blocked or <em>throttled</em> to slow down. This is done to protect the system from overloading, allowing you to introduce<br>
a scenario to allow CAS 120 authentication requests per minute with a refill rate of 10 requests per second that would continually increase in the capacity bucket.</p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle-bucket4j" %}</p>
<h2>
<a id="failure-throttling" class="anchor" href="#failure-throttling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Failure Throttling</h2>
<p>CAS provides a facility for limiting failed login attempts to support password guessing and related abuse scenarios.<br>
A couple strategies are provided for tracking failed attempts:</p>
<ol>
<li>Source IP - Limit successive failed logins against any username from the same IP address.</li>
<li>Source IP and username - Limit successive failed logins against a particular user from the same IP address.</li>
</ol>
<p>All login throttling components that ship with CAS limit successive failed login attempts that exceed a threshold<br>
rate in failures per second. The following properties are provided to define the failure rate.</p>
<ul>
<li>
<code>failureRangeInSeconds</code> - Period of time in seconds during which the threshold applies.</li>
<li>
<code>failureThreshold</code> - Number of failed login attempts permitted in the above period.</li>
</ul>
<p>A failure rate of more than 1 per 3 seconds is indicative of an automated authentication attempt, which is a<br>
reasonable basis for throttling policy. Regardless of policy care should be taken to weigh security against access;<br>
overly restrictive policies may prevent legitimate authentication attempts.</p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle" %}</p>
<h3>
<a id="administrative-endpoints" class="anchor" href="#administrative-endpoints" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Administrative Endpoints</h3>
<p>The following endpoints are provided by CAS:</p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>throttles</code></td>
<td>
<code>GET</code> request to fetch throttled records.</td>
</tr>
</tbody>
</table>
<h3>
<a id="ip-address" class="anchor" href="#ip-address" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>IP Address</h3>
<p>Uses a memory map to prevent successive failed login attempts from the same IP address.</p>
<h3>
<a id="ip-address-and-username" class="anchor" href="#ip-address-and-username" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>IP Address and Username</h3>
<p>Uses a memory map to prevent successive failed login attempts for<br>
a particular username from the same IP address.</p>
<h3>
<a id="jdbc" class="anchor" href="#jdbc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>JDBC</h3>
<p>Queries a database data source used by the CAS audit facility to prevent successive failed login attempts for a particular username from the same IP address.<br>
This component requires and depends on the <a href="Audits.html">CAS auditing functionality</a> via databases.</p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle-jdbc" %}</p>
<p>For additional instructions on how to configure auditing, please <a href="Audits.html">review the following guide</a>.</p>
<h3>
<a id="mongodb" class="anchor" href="#mongodb" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>MongoDb</h3>
<p>Queries a MongoDb data source used by the CAS audit facility to prevent successive failed login attempts for a particular username from the same IP address. This component requires and depends on the <a href="Audits.html">CAS auditing functionality</a> via MongoDb.</p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle-mongo" %}</p>
<h3>
<a id="redis" class="anchor" href="#redis" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Redis</h3>
<p>Queries a Redis data source used by the CAS audit facility to prevent successive failed login attempts<br>
for a particular username from the same IP address. This component requires and<br>
depends on the <a href="Audits.html">CAS auditing functionality</a> via Redis.</p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle-redis" %}</p>
<h3>
<a id="hazelcast" class="anchor" href="#hazelcast" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hazelcast</h3>
<p>This feature uses a distributed Hazelcast map to record throttled authentication attempts.<br>
This component requires and depends on the <a href="Audits.html">CAS auditing functionality</a></p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle-hazelcast" %}</p>
<h3>
<a id="couchdb" class="anchor" href="#couchdb" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CouchDb</h3>
<p>Queries a CouchDb data source used by the CAS audit facility to prevent successive failed login attempts<br>
for a particular username from the same IP address. This component requires and<br>
depends on the <a href="Audits.html">CAS auditing functionality</a> via CouchDb.</p>
<p>Enable the following module in your configuration overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-throttle-couchdb" %}</p>
<p>For additional instructions on how to configure auditing, please <a href="Audits.html">review the following guide</a>.</p>
<h2>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration</h2>
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#authentication-throttling">review this guide</a>.</p>
<h2>
<a id="high-availability" class="anchor" href="#high-availability" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>High Availability</h2>
<p>All of the throttling components are suitable for a CAS deployment that satisfies the<br>
<a href="../high_availability/High-Availability-Guide.html">recommended HA architecture</a>. In particular deployments with multiple CAS<br>
nodes behind a load balancer configured with session affinity can use either in-memory or <em>inspektr</em> components. It is<br>
instructive to discuss the rationale. Since load balancer session affinity is determined by source IP address, which<br>
is the same criterion by which throttle policy is applied, an attacker from a fixed location should be bound to the<br>
same CAS server node for successive authentication attempts. A distributed attack, on the other hand, where successive<br>
request would be routed indeterminately, would cause haphazard tracking for in-memory CAS components since attempts<br>
would be split across N systems. However, since the source varies, accurate accounting would be pointless since the<br>
throttling components themselves assume a constant source IP for tracking purposes. The login throttling components<br>
are not sufficient for detecting or preventing a distributed password brute force attack.</p>