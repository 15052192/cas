<hr>
<h2>
<a id="layout-defaulttitle-cas---configuring-sso-sessionscategory-sso--slo" class="anchor" href="#layout-defaulttitle-cas---configuring-sso-sessionscategory-sso--slo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Configuring SSO Sessions<br>
category: SSO &amp; SLO</h2>
<h1>
<a id="sso-sessions" class="anchor" href="#sso-sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SSO Sessions</h1>
<p>A ticket-granting cookie is an HTTP cookie set by CAS upon the establishment of a single sign-on session. This cookie maintains login<br>
state for the client, and while it is valid, the client can present it to CAS in lieu of primary credentials.<br>
Services can opt out of single sign-on through the <code>renew</code> parameter or the CAS server may conditionally opt the service out<br>
based on the policies defined for the application in the service registry. See the <a href="../protocol/CAS-Protocol.html">CAS Protocol</a> for more info.</p>
<p>The cookie value is linked to the active ticket-granting ticket, the remote IP address that initiated the request<br>
as well as the user agent that submitted the request. The final cookie value is then encrypted and signed.</p>
<p>These keys <strong>MUST</strong> be regenerated per your specific environment. Each key<br>
is a JSON Web Token with a defined length per the algorithm used for encryption and signing.</p>
<p>In the event that keys are not generated by the deployer, CAS will attempt to auto-generate keys and will output<br>
the result for each respected key. The deployer MUST attempt to copy the generated keys over to the appropriate<br>
settings in their CAS properties file, specially when running a multi-node CAS deployment. Failure to do so will prevent CAS<br>
to appropriate decrypt and encrypt the cookie value and will prevent successful single sign-on.</p>
<!-- raw HTML omitted -->
<h2>
<a id="administrative-endpoints" class="anchor" href="#administrative-endpoints" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Administrative Endpoints</h2>
<p>The following endpoints are provided by CAS:</p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ssoSessions</code></td>
<td>Review the current single sign-on sessions established with CAS and manage each session remotely. A <code>GET</code> operation produces a list of current SSO sessions that are filtered by a provided <code>type</code> parameter with values <code>ALL</code>, <code>PROXIED</code> or <code>DIRECT</code>. A <code>DELETE</code> operation without specifying a ticket id will attempt to destroy all SSO sessions. Specifying a ticket-granting ticket identifier in the URL as a placeholder/selector will attempt to destroy the session controlled by that ticket. (i.e. <code>ssoSessions/{ticket}</code>).</td>
</tr>
<tr>
<td><code>sso</code></td>
<td>Indicate the current status of the single sign-on session tied to the browser session and the SSO cookie.</td>
</tr>
</tbody>
</table>
<h2>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration</h2>
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#ticket-granting-cookie">review this guide</a>.</p>
<p>The cookie has the following properties:</p>
<ol>
<li>It is marked as secure.</li>
<li>Depending on container support, the cookie would be marked as http-only automatically.</li>
<li>The cookie value is encrypted and signed via secret keys that need to be generated upon deployment.</li>
</ol>
<p>If keys are left undefined, on startup CAS will notice that no keys are defined and it will appropriately generate keys for you automatically. Your CAS logs will then show the following snippet:</p>
<pre lang="bash"><code>WARN [...] - &lt;Secret key for encryption is not defined. CAS will auto-generate the encryption key&gt;
WARN [...] - &lt;Generated encryption key ABC of size ... . The generated key MUST be added to CAS settings.&gt;
WARN [...] - &lt;Secret key for signing is not defined. CAS will auto-generate the signing key&gt;
WARN [...] - &lt;Generated signing key XYZ of size ... . The generated key MUST be added to CAS settings.&gt;
</code></pre>
<p>You should then grab each generated key for encryption and signing, and put them inside your CAS properties for each setting.<br>
If you wish you manually generate keys, you may <a href="https://github.com/mitreid-connect/json-web-key-generator">use the following tool</a>.</p>
<h2>
<a id="cookie-generation-for-renewed-authentications" class="anchor" href="#cookie-generation-for-renewed-authentications" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cookie Generation for Renewed Authentications</h2>
<p>By default, forced authentication requests that challenge the user for credentials<br>
either via the <a href="../protocol/CAS-Protocol.html"><code>renew</code> request parameter</a><br>
or via <a href="../services/Service-Management.html">the service-specific setting</a> of<br>
the CAS service registry will always generate the ticket-granting cookie<br>
nonetheless. What this means is, logging in to a non-SSO-participating application<br>
via CAS nonetheless creates a valid CAS single sign-on session that will be honored on a<br>
subsequent attempt to authenticate to a SSO-participating application.</p>
<p>The cookie generation strategy can also be customized on a per-application basis. For additional details,<br>
please <a href="../services/Configuring-Service-SSO-Policy.html">review this guide</a>.</p>
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#global-sso-behavior">review this guide</a>.</p>
<h2>
<a id="disable-sso-globally" class="anchor" href="#disable-sso-globally" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Disable SSO Globally</h2>
<p>Participation in single sign-on sessions can be disabled globally via CAS properties. To see the relevant list of CAS<br>
properties, please <a href="../configuration/Configuration-Properties.html#global-sso-behavior">review this guide</a>.</p>
<h2>
<a id="disable-service-sso-access" class="anchor" href="#disable-service-sso-access" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Disable Service SSO Access</h2>
<p>Participation in existing single signon sessions can be disabled on a per applications. For example,<br>
the following service will be challenged to present credentials every time, thereby not using SSO:</p>
<pre lang="json"><code>{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "...",
  "name" : "...",
  "id" : 1,
  "accessStrategy" : {
    "@class" : "org.apereo.cas.services.DefaultRegisteredServiceAccessStrategy",
    "ssoEnabled" : false
  }
}
</code></pre>
<h2>
<a id="sso-participation-policies" class="anchor" href="#sso-participation-policies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SSO Participation Policies</h2>
<p>The single sign-on participation strategy can also be customized on a per-application basis. For additional details,<br>
please <a href="../services/Configuring-Service-SSO-Policy.html">review this guide</a>.</p>
<h2>
<a id="sso-warning-session-cookie" class="anchor" href="#sso-warning-session-cookie" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SSO Warning Session Cookie</h2>
<p>A warning cookie set by CAS upon the establishment of the SSO session at the request of the user on the CAS login page.<br>
The cookie is used later to warn and prompt the user before a service ticket is generated and access to the service application is granted.</p>
<p>To see the relevant list of CAS properties,<br>
please <a href="../configuration/Configuration-Properties.html#warning-cookie">review this guide</a>.</p>
<h2>
<a id="public-workstations" class="anchor" href="#public-workstations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Public Workstations</h2>
<p>CAS has the ability to allow the user to opt-out of SSO, by indicating on the login page that the authentication<br>
is happening at a public workstation. By electing to do so, CAS will not honor the subsequent SSO session<br>
and will not generate the TGC that is designed to do so.</p>
<pre lang="html"><code>...
&lt;input id="publicWorkstation"
       name="publicWorkstation"
       value="false" tabindex="4"
       type="checkbox" /&gt;
&lt;label for="publicWorkstation" th:utext="#{screen.welcome.label.publicstation}"/&gt;
...
</code></pre>
<h2>
<a id="default-service" class="anchor" href="#default-service" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Default Service</h2>
<p>In the event that no <code>service</code> is submitted to CAS, you may specify a default<br>
service url to which CAS will redirect. Note that this default service, much like<br>
all other services, MUST be authorized and registered with CAS.</p>
<p>To see the relevant list of CAS properties,<br>
please <a href="../configuration/Configuration-Properties.html#views">review this guide</a>.</p>
<h2>
<a id="required-service" class="anchor" href="#required-service" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Required Service</h2>
<p>CAS may be configured to require the user to authenticate from an application before<br>
access can be granted to all other registered services. Once CAS finds a record for the required<br>
application as part of the single sign-on session records, it will permit authentication attempts<br>
by all other services until the single sign-on session is destroyed.</p>
<p>Such validation checks can be turned off and skipped on a per-application basis:</p>
<pre lang="json"><code>{
  "@class": "org.apereo.cas.services.RegexRegisteredService",
  "serviceId": "^https://www.example.com",
  "name": "Example",
  "id": 1,
  "description": "Example",
  "properties" : {
    "@class" : "java.util.HashMap",
    "skipRequiredServiceCheck" : {
      "@class" : "org.apereo.cas.services.DefaultRegisteredServiceProperty",
      "values" : [ "java.util.HashSet", [ "true" ] ]
    }
  }
}
</code></pre>
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#global-sso-behavior">review this guide</a>.</p>