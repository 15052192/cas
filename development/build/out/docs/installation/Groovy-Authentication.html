<hr>
<h2>
<a id="layout-defaulttitle-cas---groovy-authenticationcategory-authentication" class="anchor" href="#layout-defaulttitle-cas---groovy-authenticationcategory-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Groovy Authentication<br>
category: Authentication</h2>
<h1>
<a id="groovy-authentication" class="anchor" href="#groovy-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Groovy Authentication</h1>
<p>Verify and authenticate credentials using Groovy scripts. The task of credential verification, principal transformation,<br>
handling password policy and all other related matters are the sole responsibility of the Groovy script.</p>
<p>Support is enabled by including the following dependency in the WAR overlay:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-generic" %}</p>
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#groovy-authentication">review this guide</a>.</p>
<p>The Groovy script may be designed as:</p>
<pre lang="groovy"><code>import org.apereo.cas.authentication.*
import org.apereo.cas.authentication.credential.*
import org.apereo.cas.authentication.metadata.*

import javax.security.auth.login.*

def authenticate(final Object... args) {
    def authenticationHandler = args[0]
    def credential = args[1]
    def servicesManager = args[2]
    def principalFactory = args[3]
    def logger = args[4]              

    /*
     * Figure out how to verify credentials...
     */
    if (authenticationWorksCorrectly()) {
        def principal = principalFactory.createPrincipal(credential.username);
        return new DefaultAuthenticationHandlerExecutionResult(authenticationHandler,
                new BasicCredentialMetaData(credential),
                principal,
                new ArrayList&lt;&gt;(0));
    }
    throw new FailedLoginException();
}

def supportsCredential(final Object... args) {
    def credential = args[0]
    def logger = args[1]
    return credential != null
}

def supportsCredentialClass(final Object... args) {
    def credentialClazz = args[0]
    def logger = args[1]
    return credentialClazz == UsernamePasswordCredential.class
}
</code></pre>