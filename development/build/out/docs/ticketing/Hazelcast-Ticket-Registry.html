<hr>
<h2>
<a id="layout-defaulttitle-cas---hazelcast-ticket-registrycategory-ticketing" class="anchor" href="#layout-defaulttitle-cas---hazelcast-ticket-registrycategory-ticketing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Hazelcast Ticket Registry<br>
category: Ticketing</h2>
<h1>
<a id="hazelcast-ticket-registry" class="anchor" href="#hazelcast-ticket-registry" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hazelcast Ticket Registry</h1>
<p>Hazelcast Ticket Registry is a distributed ticket registry implementation<br>
based on <a href="http://hazelcast.org/">Hazelcast distributed grid library</a>. The registry implementation is<br>
cluster-aware and is able to auto-join a cluster of all the CAS nodes that expose this registry.<br>
Hazelcast will use port auto-increment feature to assign a TCP port to each member of a cluster starting<br>
from initially provided arbitrary port, which is typically <code>5701</code> by default.</p>
<p>Hazelcast will evenly distribute the ticket data among all the members of a cluster in a very<br>
efficient manner. Also, by default, the data collection on each node is configured with 1 backup copy,<br>
so that Hazelcast will use it to make strong data consistency guarantees i.e. the loss of data on<br>
live nodes will not occur should any other <em>primary data owner</em> members die. The data will be<br>
re-partitioned among the remaining live cluster members.</p>
<p>Support is enabled by the following module:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-hazelcast-ticket-registry" %}</p>
<h2>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration</h2>
<p>This module has a configuration strategy which by default auto-configures a hazelcast instance used by the ticket registry implementation to build and retrieve Hazelcast's maps for its distributed tickets storage. Some aspects of hazelcast configuration in this auto-configuration mode are controlled by CAS properties.</p>
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#hazelcast-ticket-registry">review this guide</a>.</p>
<!-- raw HTML omitted -->
<p>For more information on the Hazelcast configuration options available,<br>
refer to <a href="http://docs.hazelcast.org/docs/3.9.1/manual/html-single/index.html#hazelcast-configuration">the Hazelcast configuration documentation</a></p>
<h2>
<a id="aws-ec2-auto-discovery" class="anchor" href="#aws-ec2-auto-discovery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>AWS EC2 Auto Discovery</h2>
<p>Hazelcast support in CAS may handle EC2 auto-discovery automatically. It is useful when you do not want to provide or you cannot provide the list of possible IP addresses for the members of the cluster. You optionally also have the ability to specify partitioning group that would be zone aware. When using the zone-aware configuration, backups are created in the other AZs. Each zone will be accepted as one partition group. Using the AWS Discovery capability requires that you turn off and disable multicast and TCP/IP config in the CAS settings, which should be done automatically by CAS at runtime.</p>
<p>Support is enabled by the following module:</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-hazelcast-discovery-aws" %}</p>
<h2>
<a id="apache-jclouds-auto-discovery" class="anchor" href="#apache-jclouds-auto-discovery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Apache jclouds Auto Discovery</h2>
<p>Hazelcast support in CAS may handle auto-discovery automatically via <a href="https://jclouds.apache.org/">Apache jclouds®</a>. It is useful when you do not want to provide or you cannot provide the list of possible IP addresses for the members of the cluster. Apache jclouds® is an open source multi-cloud toolkit for the Java platform that gives you the freedom to create applications that are portable across clouds while giving you full control to use cloud-specific features. To see the full list of supported cloud environments, <a href="https://jclouds.apache.org/reference/providers/#compute">please see this link</a>.</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-hazelcast-discovery-jclouds" %}</p>
<h2>
<a id="microsoft-azure-auto-discovery" class="anchor" href="#microsoft-azure-auto-discovery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Microsoft Azure Auto Discovery</h2>
<p>Hazelcast support in CAS may handle auto-discovery automatically via Microsoft Azure. The discovery strategy will provide all Hazelcast instances by returning VMs within your Azure resource group that are tagged with a specified value. You will need to setup <a href="https://azure.microsoft.com/en-us/documentation/articles/resource-group-create-service-principal-portal/">Azure Active Directory Service Principal credentials</a> for your Azure Subscription for this plugin to work. With every Hazelcast Virtual Machine you deploy in your resource group, you need to ensure that each VM is tagged with the value of <code>clusterId</code> defined in the CAS Hazelcast configuration. The only requirement is that every VM can access each other either by private or public IP address.</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-hazelcast-discovery-azure" %}</p>
<h2>
<a id="kubernetes-auto-discovery" class="anchor" href="#kubernetes-auto-discovery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Kubernetes Auto Discovery</h2>
<p>This hazelcast discovery plugin provides the possibility to lookup IP addresses of other members by resolving<br>
those requests against a <a href="http://kubernetes.io/">Kubernetes</a> Service Discovery system.</p>
<p>This module supports two different options of resolving against the discovery registry:</p>
<ul>
<li>A request to the REST API</li>
<li>DNS Lookup against a given headless DNS service name</li>
</ul>
<p>See <a href="https://github.com/hazelcast/hazelcast-kubernetes">this link</a> for more info.</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-hazelcast-discovery-kubernetes" %}</p>
<h2>
<a id="docker-swarm-auto-discovery" class="anchor" href="#docker-swarm-auto-discovery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Docker Swarm Auto Discovery</h2>
<p>This hazelcast discovery plugin provides a Docker Swarm mode based discovery strategy.</p>
<p>See <a href="https://github.com/bitsofinfo/hazelcast-docker-swarm-discovery-spi/">this link</a> for more info.</p>
<p>{% include casmodule.html group="org.apereo.cas" module="cas-server-support-hazelcast-discovery-swarm" %}</p>
<h2>
<a id="multicast-auto-discovery" class="anchor" href="#multicast-auto-discovery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multicast Auto Discovery</h2>
<p>With the multicast auto-discovery mechanism, Hazelcast allows cluster members to find each other using multicast communication. The cluster members do not need to know the concrete addresses of the other members, as they just multicast to all the other members for listening. Whether multicast is possible or allowed <strong>depends on your environment</strong>.</p>
<p>Pay special attention to timeouts when multicast is enabled. Multicast timeout specifies the time in seconds that a member should wait for a valid multicast response from another member running in the network before declaring itself the leader member (the first member joined to the cluster) and creating its own cluster. This only applies to the startup of members where no leader has been assigned yet. If you specify a high value such as 60 seconds, it means that until a leader is selected each member will wait 60 seconds before moving on. Be careful when providing a high value. Also, be careful not to set the value too low, or the members might give up too early and create their own cluster.</p>
<h2>
<a id="wan-replication" class="anchor" href="#wan-replication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WAN Replication</h2>
<p>Hazelcast WAN Replication allows you to keep multiple Hazelcast clusters in sync by replicating their state over WAN environments such as the Internet.</p>
<!-- raw HTML omitted -->
<p>Hazelcast supports two different operation modes of WAN Replication:</p>
<ul>
<li>Active-Passive: This mode is mostly used for failover scenarios where you want to replicate an active cluster to one or more passive clusters, for the purpose of maintaining a backup.</li>
<li>Active-Active: Every cluster is equal, each cluster replicates to all other clusters. This is normally used to connect different clients to different clusters for the sake of the shortest path between client and server.</li>
</ul>
<p>See <a href="https://hazelcast.com/products/wan-replication/">this page</a> for more information.</p>
<p>Defining WAN replication endpoints in CAS is done using static endpoints and discovery.</p>
<h2>
<a id="logging" class="anchor" href="#logging" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Logging</h2>
<p>To enable additional logging for the registry, configure the log4j configuration file to add the following<br>
levels:</p>
<pre lang="xml"><code>...
&lt;Logger name="com.hazelcast" level="debug" additivity="false"&gt;
    &lt;AppenderRef ref="console"/&gt;
    &lt;AppenderRef ref="file"/&gt;
&lt;/Logger&gt;
...
</code></pre>