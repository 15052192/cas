<hr>
<h2>
<a id="layout-defaulttitle-cas---delegate-authentication-w-saml2-identity-providerscategory-authentication" class="anchor" href="#layout-defaulttitle-cas---delegate-authentication-w-saml2-identity-providerscategory-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Delegate Authentication w/ SAML2 Identity Providers<br>
category: Authentication</h2>
<h1>
<a id="delegated-authentication-w-saml2" class="anchor" href="#delegated-authentication-w-saml2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Delegated Authentication w/ SAML2</h1>
<p>In the event that CAS is configured to delegate authentication to an external identity provider, the service provider (CAS)<br>
metadata as well as the identity provider metadata automatically become available at the following endpoints:</p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/sp/metadata</code></td>
<td>Displays the service provider (CAS) metadata. Works well if there is only one SAML2 IdP is defined.</td>
</tr>
<tr>
<td><code>/sp/idp/metadata</code></td>
<td>Displays the identity provider metadata. Works well if there is only one SAML2 IdP is defined.</td>
</tr>
<tr>
<td><code>/sp/{clientName}/metadata</code></td>
<td>Displays the service provider metadata for the requested client name.</td>
</tr>
<tr>
<td><code>/sp/{clientName}/idp/metadata</code></td>
<td>Displays the identity provider metadata for the requested client name.</td>
</tr>
</tbody>
</table>
<p>Note that you can use more than one external identity provider with CAS, where each integration may be done<br>
with a different set of metadata and keys for CAS acting as the service provider. Each integration (referred to as a client,<br>
since CAS itself becomes a client of the identity provider) may be given a name optionally.</p>
<p>Remember that the service provider (CAS) metadata is automatically generated once you access the above<br>
endpoints or view the CAS login screen. This is required because today, generating the metadata requires<br>
access to the HTTP request/response. In the event that metadata cannot<br>
be resolved, a status code of <code>406 - Not Acceptable</code> is returned.</p>
<h2>
<a id="identity-provider-discovery-service" class="anchor" href="#identity-provider-discovery-service" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Identity Provider Discovery Service</h2>
<!-- raw HTML omitted -->
<pre lang="xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apereo.cas&lt;/groupId&gt;
    &lt;artifactId&gt;cas-server-support-saml-idp-discovery&lt;/artifactId&gt;
    &lt;version&gt;${cas.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>Identity provider discovery allows CAS to <a href="https://wiki.shibboleth.net/confluence/display/EDS10/Embedded+Discovery+Service">embed and present a discovery service</a> as part of delegated authentication. Configured SAML2 identity providers in the CAS configuration<br>
used for delegated authentication are presented as options for discovery.</p>
<p>CAS is also able to directly consume multiple JSON feeds<br>
that contain discovery metadata about available identity providers. The discovery JSON feed<br>
may be fetched from a URL (i.e. exposed by a Shibboleth Service Provider) or it may<br>
directly be consumed as a JSON file with the following structure:</p>
<pre lang="json"><code>[{
 "entityID": "https://idp.example.net/idp/saml",
 "DisplayNames": [{
  "value": "Example.net",
  "lang": "en"
  }],
 "Descriptions": [{
  "value": "An identity provider for the people, by the people.",
  "lang": "en"
  }],
 "Logos": [{
  "value": "https://example.net/images/logo.png",
  "height": "90",
  "width": "62"
  }]
}]
</code></pre>
<p>To see the relevant list of CAS properties,<br>
please <a href="../configuration/Configuration-Properties.html#saml2-identity-provider-discovery">review this guide</a>.</p>
<p>The following endpoints are available:</p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/idp/discovery</code></td>
<td>Identity provider discovery landing page.</td>
</tr>
<tr>
<td><code>/idp/discovery/feed</code></td>
<td>Identity provider discovery JSON feed.</td>
</tr>
<tr>
<td><code>/idp/discovery/redirect</code></td>
<td>Return endpoint to let CAS invoke the identity provider after selection.</td>
</tr>
</tbody>
</table>
<p>Applications may directly invoke the discovery service via <code>[cas-server-prefix]/idp/discovery</code>. The discovery service may also<br>
be invoked using the discovery protocol via <code>[cas-server-prefix]/idp/discovery?entityID=[service-provider-entity-id]&amp;return=[cas-server-prefix]/idp/discovery/redirect</code>.<br>
Additional parameters may be included as part of the <code>return</code> url and they all must be encoded.</p>