<hr>
<h2>
<a id="layout-defaulttitle-cas---upgrade-guidecategory-planning" class="anchor" href="#layout-defaulttitle-cas---upgrade-guidecategory-planning" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Upgrade Guide<br>
category: Planning</h2>
<h1>
<a id="upgrade-guide" class="anchor" href="#upgrade-guide" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Upgrade Guide</h1>
<p>In general, it is recommended that adopters try to keep their CAS deployment in alignment with the latest CAS version available.<br>
In particular, releases that are of <code>PATCH</code> or <code>SECURITY</code> nature should be immediately applied as they are drop-in replacements<br>
for their corresponding parent version. See CAS <a href="../../developer/Release-Policy.html">Release Policy</a> for more info.</p>
<p>The general objectives of a CAS upgrade could be:</p>
<ol>
<li>Does the upgrade fix a critical security vulnerability or annoying issue? Is my CAS deployment<br>
affected by that vulnerability and/or bug?</li>
<li>Does the upgrade present features that might be useful to achieve local use cases?</li>
<li>Does the upgrade provide functionality that is carried locally within my overlay, such that by getting rid of those<br>
local changes, I can realize their benefit from CAS directly and end up with a smaller more-maintainable overlay?</li>
</ol>
<p>This document attempts to describe, at a very high level, the scope and effort required to upgrade a given<br>
<a href="../installation/WAR-Overlay-Installation.html">CAS deployment</a>. Rather than describing all steps/changes that would be required<br>
to review and adjust (which would be impossible), we describe a strategy by which the upgrade could be executed.</p>
<h2>
<a id="change-log" class="anchor" href="#change-log" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Change Log</h2>
<p>Before attempting to upgrade, please review the <a href="https://github.com/apereo/cas/releases">CAS change log</a> to determine<br>
what changes/fixes are contained in the version you intend to upgrade to, and whether those are applicable to your environment<br>
and your CAS deployment. If you are working with an older CAS version and are experiencing what appears to be a bug, chances are<br>
by reviewing the change log, you will find a drop-in replacement for your overlay that takes care of the issue.</p>
<h2>
<a id="discuss-issue" class="anchor" href="#discuss-issue" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Discuss Issue</h2>
<p>Having reviewed the change log, if you do not see an improvement that fixes/adjusts the behavior you have in mind,<br>
please discuss the issue on the appropriate CAS mailing lists. The result of the discussing would be a scope/effort<br>
evaluation to determine feasibility of the solution and the target version in which the fix will be done.</p>
<h2>
<a id="scope-review" class="anchor" href="#scope-review" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Scope Review</h2>
<p>Once you decide your ideal CAS version for the upgrade, before attempting to upgrade,<br>
please review the CAS <a href="../../developer/Release-Policy.html">Release Policy</a>. This will provide you<br>
with an understanding of what changes you may expect from new version and what the required effort<br>
may be for the upgrade.</p>
<h2>
<a id="evaluate-local-overlay" class="anchor" href="#evaluate-local-overlay" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Evaluate Local Overlay</h2>
<p>As a best practice, it is recommended that you deploy CAS via the <a href="../installation/WAR-Overlay-Installation.html">overlay method</a>.<br>
If you have, the task here would be to identify the number of files your overlay has touched and modified. Catalog the<br>
what and why of the changes applied, and cross-check those changes with the CAS change log. Chances are, many of the<br>
local changes that are present within your overlay are provided by default via CAS as a result of that upgrade which will<br>
have you shed many of those improvements locally.</p>
<p>Your changes typically are:</p>
<ul>
<li>Authentication scheme and strategy (i.e. LDAP, JDBC, etc)</li>
<li>Settings controlling CAS behavior in CAS properties files</li>
<li>User Interface changes may include CSS and JavaScript</li>
<li>Attribute resolution and release policy</li>
<li>Services registered and authorized to use CAS</li>
</ul>
<h2>
<a id="prepare-development-environment" class="anchor" href="#prepare-development-environment" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prepare Development Environment</h2>
<!-- raw HTML omitted -->
<p>Um, No.</p>
<p>Make sure you have a separate development environment ready for configuration and testing. Regardless of how small<br>
the upgrade is, you want to make sure it is well tested in your environment before you flip the switch. Evaluate<br>
the software dependencies and platform requirements of the new upgrade (i.e. Java, etc)<br>
and make sure you have everything installed and configured correctly before you attempt.</p>
<h2>
<a id="sanitize-configuration" class="anchor" href="#sanitize-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sanitize Configuration</h2>
<p>We recommend that you first start out with a separate clean <a href="../installation/WAR-Overlay-Installation.html">CAS overlay</a> targeted<br>
at the version to which you want to upgrade. This has the advantage of guaranteeing that your new CAS deployment<br>
will be functional without any local changes. Build and deploy the clean CAS overlay once to make sure<br>
your build/deployment process is functional.</p>
<h2>
<a id="apply-changes" class="anchor" href="#apply-changes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Apply Changes</h2>
<p>Go through your catalog of changes found in your local overlay. Compare and diff those files with their<br>
original version. You can find out the delta between two versions via the following ways:</p>
<ol>
<li>
<p>If you have built the clean CAS overlay once, you will automatically get the original version typically<br>
in the <code>target</code> or <code>build/libs</code> directory of CAS overlay. Find the correct file at the correct path and compare.</p>
</li>
<li>
<p>Go directly to the <a href="https://github.com/apereo/cas">project source repository</a>, find the appropriate branch<br>
and compare files.</p>
</li>
</ol>
<p>Needless to say, you are going to need:</p>
<ol>
<li>A decent diff tool, such as <a href="http://kdiff3.sourceforge.net/">KDiff3</a>, <a href="http://winmerge.org">WinDiff</a>,<br>
<a href="http://www.scootersoftware.com/">Beyond Compare</a>, etc.</li>
<li>A decent intelligent text editor, such as <a href="http://www.sublimetext.com">Sublime</a>,<br>
<a href="https://atom.io/">Atom</a> or a full blown IDE such as <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a>.</li>
</ol>
<h2>
<a id="document-changes" class="anchor" href="#document-changes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Document Changes</h2>
<p>Remember to document the remaining changes that exist within your local overlay, so that the next time you do the<br>
same process, you have a clue as for why the overlay looks the way it does.</p>