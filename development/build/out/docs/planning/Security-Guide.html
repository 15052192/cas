<hr>
<h2>
<a id="layout-defaulttitle-cas---security-guidecategory-planning" class="anchor" href="#layout-defaulttitle-cas---security-guidecategory-planning" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout: default<br>
title: CAS - Security Guide<br>
category: Planning</h2>
<h1>
<a id="security-guide" class="anchor" href="#security-guide" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Security Guide</h1>
<p>CAS is security software that provides secure Web-based single sign-on to Web-based applications. Single sign-on<br>
provides a win/win in terms of security and convenience: it reduces password exposure to a single, trusted credential<br>
broker while transparently providing access to multiple services without repetitious logins. The use of CAS generally<br>
improves the security environment, but there are several CAS configuration, policy, and deployment concerns that should<br>
be considered to achieve suitable security.</p>
<!-- raw HTML omitted -->
<h2>
<a id="announcements" class="anchor" href="#announcements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Announcements</h2>
<ul>
<li><a href="https://apereo.github.io/2020/10/14/gauthvuln/">Oct 14 2020 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2020/07/24/credvuln/">July 24 2020 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2020/02/08/webflowcrypto/">Feb 8 2020 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2019/12/20/surrogatevuln/">Dec 20 2019 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2019/11/24/smfavuln/">Nov 21 2019 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2019/09/27/numvulndisc/">Sep 27 2019 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2018/09/26/mfavulndisc/">Sep 26 2018 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2017/03/06/moncfgsecvulndisc/">Mar 6 2017 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2016/10/24/servlvulndisc/">Oct 24 2016 Vulnerability Disclosure</a></li>
<li><a href="https://apereo.github.io/2016/04/08/commonsvulndisc/">Apr 8 2016 Vulnerability Disclosure</a></li>
</ul>
<h2>
<a id="system-security-considerations" class="anchor" href="#system-security-considerations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>System Security Considerations</h2>
<p>Infrastructure security matters to consider may include the following.</p>
<h3>
<a id="secure-transport-https" class="anchor" href="#secure-transport-https" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Secure Transport (https)</h3>
<p>All communication with the CAS server MUST occur over a secure channel (i.e. TLSv1). There are two primary<br>
justifications for this requirement:</p>
<ol>
<li>The authentication process requires transmission of security credentials.</li>
<li>The CAS ticket-granting ticket is a bearer token.</li>
</ol>
<p>Since the disclosure of either data would allow impersonation attacks, it's vitally important to secure the<br>
communication channel between CAS clients and the CAS server.</p>
<p>Practically, it means that all CAS urls must use HTTPS, but it <strong>also</strong> means that all connections<br>
from the CAS server to the application must be done using HTTPS:</p>
<ul>
<li>when the generated service ticket is sent back to the application on the "service" url</li>
<li>when a proxy callback url is called.</li>
</ul>
<p>To see the relevant list of CAS properties and tune this behavior, please <a href="../configuration/Configuration-Properties.html#http-client">review this guide</a>.</p>
<h3>
<a id="connections-to-dependent-systems" class="anchor" href="#connections-to-dependent-systems" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Connections to Dependent Systems</h3>
<p>CAS commonly requires connections to other systems such as LDAP directories, databases, and caching services.<br>
We generally recommend to use secure transport (SSL/TLS, IPSec) to those systems where possible, but there may<br>
be compensating controls that make secure transport unnecessary. Private networks and corporate networks with strict<br>
access controls are common exceptions, but secure transport is recommended nonetheless.<br>
Client certification validation can be another good solution for LDAP to bring sufficient security.</p>
<p>As stated previously, connections to other systems must be secured. But if the CAS server is deployed on several nodes,<br>
the same applies to the CAS server itself. If a cache-based ticket registry runs without any security issue on a single<br>
CAS server, synchronization can become a security problem when using multiple nodes if the network is not protected.</p>
<p>Any disk storage is also vulnerable if not properly secured. EhCache overflow to disk may be turned off to increase<br>
protection whereas advanced encryption data mechanism should be used for the database disk storage.</p>
<h2>
<a id="deployment-driven-security-features" class="anchor" href="#deployment-driven-security-features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Deployment-Driven Security Features</h2>
<p>CAS supports a number of features that can be leveraged to implement various security policies.<br>
The following features are provided through CAS configuration and CAS client integration. Note that many features<br>
are available out of the box, while others require explicit setup</p>
<h3>
<a id="forced-authentication" class="anchor" href="#forced-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Forced Authentication</h3>
<p>Many CAS clients and supported protocols support the concept of forced authentication whereby a user must<br>
re-authenticate to access a particular service. The CAS protocols support forced authentication via the <em>renew</em><br>
parameter. Forced authentication provides additional assurance in the identity of<br>
the principal of an SSO session since the user must verify his or her credentials prior to access.<br>
Forced authentication is suitable for services where higher security is desired or mandated. Typically forced<br>
authentication is configured on a per-service basis, but the <a href="#service-management">service management</a> facility<br>
provides some support for implementing forced authentication as a matter of centralized security policy.<br>
Forced authentication may be combined with<br>
<a href="../configuration/Configuration-Properties.html#multifactor-authentication">multi-factor authentication</a> features to<br>
implement arbitrary service-specific access control policy.</p>
<h3>
<a id="passive-authentication" class="anchor" href="#passive-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Passive Authentication</h3>
<p>Some CAS protocols support passive authentication where access to a CAS-protected service is granted anonymously<br>
when requested. The CASv2 and CASv3 protocols support this capability via the <em>gateway</em> feature. Passive authentication<br>
complements forced authentication; where forced authentication requires authentication to access a service, passive<br>
authentication permits service access, albeit anonymously, without authentication.</p>
<h3>
<a id="proxy-authentication" class="anchor" href="#proxy-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Proxy Authentication</h3>
<p>Proxy authentication, or delegated authentication, provides a powerful, important, and potentially security-improving<br>
feature of CAS. Proxy authentication is supported by the CASv2 and CASv3 protocols and is mediated by proxy tickets<br>
that are requested by a service on behalf of a user; thus the service proxies authentication for the user.<br>
Proxy authentication is commonly used in cases where a service cannot interact directly with the user and as an<br>
alternative to replaying end-user credentials to a service.</p>
<p>However, proxy tickets carry risk in that services accepting proxy tickets are responsible for validating the<br>
proxy chain (the list of services through which the end-user's authentication have been delegated to arrive at<br>
the ticket validating service). Services can opt out of accepting proxy tickets entirely (and avoid<br>
responsibility for validating proxy chains) by validating tickets against the /serviceValidate<br>
validation endpoint, but experience has shown it's easy to be confused about this and configure to<br>
unintentionally use the /proxyValidate endpoint yet not scrutinize any proxy chains that appear in the<br>
ticket validation response. Thus proxy authentication requires careful configuration for proper security controls;<br>
it is recommended to disable proxy authentication components at the CAS server if proxy authentication is not<br>
needed.</p>
<p>Historically any service could obtain a proxy-granting ticket and from it a proxy ticket to access any other service.<br>
In other words, the security model is decentralized rather than centralized. The service management facility affords<br>
some centralized control of proxy authentication by exposing a proxy authentication flag that can enabled or disabled<br>
on a per-service basis. By default registered services are not granted proxy authentication capability.</p>
<h3>
<a id="credential-caching-and-replay" class="anchor" href="#credential-caching-and-replay" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Credential Caching and Replay</h3>
<p>The <em>ClearPass</em> extension provides a mechanism to capture primary authentication credentials, cache them (encrypted),<br>
and replay on demand as needed to access legacy services. While <a href="#proxy-authentication">proxy authentication</a><br>
is recommended in lieu of password replay, it may be required to integrate legacy services with CAS. See the<br>
<a href="../integration/ClearPass.html">ClearPass</a> documentation for detailed information.</p>
<h3>
<a id="service-management" class="anchor" href="#service-management" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Service Management</h3>
<p>The service management facility provides a number of service-specific configuration controls that affect security<br>
policy and provide some support for centralized security policy. (Note that CAS has historically supported the<br>
decentralized security policy model.) Some highlights of service management controls:</p>
<ul>
<li>Authorized services</li>
<li>Forced authentication</li>
<li>Attribute release</li>
<li>Proxy authentication control</li>
<li>Theme control</li>
<li>Service authorization control</li>
<li>Multi-factor service access policy</li>
</ul>
<p>The service management facility is comprised of a service registry containing one or more registered services, each<br>
of which specifies the management controls above. The service registry can be controlled via static configuration files,<br>
a Web user interface, or both. See the <a href="../services/Service-Management.html">Service Management</a> section for more<br>
information.</p>
<!-- raw HTML omitted -->
<h3>
<a id="sso-cookie-encryption" class="anchor" href="#sso-cookie-encryption" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SSO Cookie Encryption</h3>
<p>A ticket-granting cookie is an HTTP cookie set by CAS upon the establishment of a single sign-on session.<br>
The cookie value is by default encrypted and signed via settings defined in CAS properties.<br>
While sample data is provided for initial deployments, these keys <strong>MUST</strong> be regenerated per your specific<br>
environment. Please <a href="../installation/Configuring-SSO.html">see this guide</a> for more info.</p>
<h3>
<a id="password-management-secure-links" class="anchor" href="#password-management-secure-links" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Password Management Secure Links</h3>
<p>Account password reset requests are handled via a secured link that is sent to the registered<br>
email address of the user. The link is available only within a defined time window<br>
and the request is properly signed and encrypted by CAS. While sample data is provided for initial deployments, these keys <strong>MUST</strong> be regenerated per your specific environment.</p>
<p>Please <a href="../installation/Password-Policy-Enforcement.html">see this guide</a> for more info.</p>
<h3>
<a id="protocol-ticket-encryption" class="anchor" href="#protocol-ticket-encryption" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Protocol Ticket Encryption</h3>
<p>Protocol tickets that are issued by CAS and shared with other applications such as service tickets may optionally go through a signing/encryption process. Even though the CAS server will always cross check ticket validity and expiration policy, this may be forced as an extra check to ensure tickets in transit to other applications are not tampered with and remain to be authentic. While sample data is provided for initial deployments, these keys <strong>MUST</strong> be regenerated per your specific environment.</p>
<!-- raw HTML omitted -->
<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#protocol-ticket-security">review this guide</a>.</p>
<h3>
<a id="ticket-registry-encryption" class="anchor" href="#ticket-registry-encryption" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ticket Registry Encryption</h3>
<p>Secure ticket replication as it regards clustered CAS deployments may be required to ensure generated tickets by CAS are not tampered with in transit. CAS covers this issue by allowing tickets to be natively encrypted and signed. While sample data is provided for initial deployments, these keys <strong>MUST</strong> be regenerated per your specific environment.<br>
Please <a href="../installation/Ticket-Registry-Replication-Encryption.html">see this guide</a> for more info.</p>
<h3>
<a id="administrative-pages-security" class="anchor" href="#administrative-pages-security" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Administrative Pages Security</h3>
<p>CAS provides a large variety of web interfaces that are aimed at system administrators and deployers.<br>
These screens along with a number of REST endpoints allow a CAS deployer to manage and reconfigure CAS behavior without resorting to<br>
native command-line interfaces. Needless to say, these endpoints and screens must be secured and allowed proper access only to<br>
authorized parties. Please <a href="../monitoring/Monitoring-Statistics.html">see this guide</a> for more info.</p>
<h3>
<a id="ticket-expiration-policies" class="anchor" href="#ticket-expiration-policies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ticket Expiration Policies</h3>
<p>Ticket expiration policies are a primary mechanism for implementing security policy. Ticket expiration policy allows<br>
control of some important aspects of CAS SSO session behavior:</p>
<ul>
<li>SSO session duration (sliding expiration, absolute)</li>
<li>Ticket reuse</li>
</ul>
<p>See the <a href="../ticketing/Configuring-Ticketing-Components.html">Configuring Ticketing Components</a> section for a<br>
detailed discussion of the various expiration policies and configuration instructions.</p>
<h3>
<a id="single-sign-out" class="anchor" href="#single-sign-out" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Single Sign-Out</h3>
<p>Single sign-out, or single log-out (SLO), is a feature by which CAS services are notified of the termination of a CAS<br>
SSO session with the expectation that services terminate access for the SSO session owner. While single sign-out can<br>
improve security, it is fundamentally a best-effort facility and may not actually terminate access to all services<br>
consumed during an SSO session. The following compensating controls may be used to improve risks associated with<br>
single sign-out shortcomings:</p>
<ul>
<li>Require forced authentication for sensitive services</li>
<li>Reduce application session timeouts</li>
<li>Reduce SSO session duration</li>
</ul>
<p>SLO can happen in two ways: from the CAS server (back-channel logout) and/or from the browser (front-channel logout).<br>
For back-channel logout, the SLO process relies on the <code>SimpleHttpClient</code> class which has a threads pool: its size must be defined to properly treat all the logout requests.<br>
Additional not-already-processed logout requests are temporarily stored in a queue before being sent: its size is defined to 20% of the global capacity of the threads pool and can be adjusted.<br>
Both sizes are critical settings of the CAS system and their values should never exceed the real capacity of the CAS server.</p>
<h3>
<a id="login-throttling" class="anchor" href="#login-throttling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Login Throttling</h3>
<p>CAS supports a policy-driven feature to limit successive failed authentication attempts to help prevent brute force<br>
and denial of service attacks. The feature is beneficial in environments where back-end authentication stores lack<br>
equivalent features. In cases where this support is available in underlying systems, we encourage using it instead<br>
of CAS features; the justification is that enabling support in underlying systems provides the feature in all dependent<br>
systems including CAS. See the<br>
<a href="../installation/Configuring-Authentication-Components.html#login-throttling">login throttling configuration</a><br>
section for further information.</p>
<h3>
<a id="credential-encryption" class="anchor" href="#credential-encryption" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Credential Encryption</h3>
<p>To learn how sensitive CAS settings can be secured via encryption, <a href="../configuration/Configuration-Properties-Security.html">please review this guide</a>.</p>
<h3>
<a id="cas-security-filter" class="anchor" href="#cas-security-filter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CAS Security Filter</h3>
<p>The CAS project provides a number of a blunt <a href="https://github.com/apereo/cas-server-security-filter">generic security filters</a> suitable for patching-in-place Java<br>
CAS server and Java CAS client deployments vulnerable to certain request parameter based bad-CAS-protocol-input attacks.<br>
The filters are configured to sanitize authentication request parameters and reject the request if it is not compliant with<br>
the CAS protocol in the event that for instance, a parameter is repeated multiple times, includes multiple values, contains unacceptable values, etc.</p>
<p>It is <strong>STRONGLY</strong> recommended that all CAS deployments be evaluated and include this configuration if necessary to prevent<br>
protocol attacks in situations where the CAS container and environment are unable to block malicious and badly-configured requests.</p>
<h4>
<a id="cors" class="anchor" href="#cors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CORS</h4>
<p>CAS provides first-class support for enabling HTTP access control (CORS).<br>
One application of CORS is when a resource makes a cross-origin HTTP request when it requests a resource from a<br>
different domain than the one which the first resource itself serves. This should help more with CAS-enabled<br>
applications are accessed via XHR/Ajax requests.</p>
<p>To see the relevant list of CAS properties and tune this behavior, please <a href="../configuration/Configuration-Properties.html#http-web-requests">review this guide</a>.</p>
<h4>
<a id="security-response-headers" class="anchor" href="#security-response-headers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Security Response Headers</h4>
<p>As part of the CAS Security Filter, the CAS project automatically provides the necessary configuration to<br>
insert HTTP Security headers into the web response to prevent against HSTS, XSS, X-FRAME and other attacks.<br>
These settings are presently on by default.<br>
To see the relevant list of CAS properties and tune this behavior, please <a href="../configuration/Configuration-Properties.html#http-web-requests">review this guide</a>.</p>
<p>To review and learn more about these options, please visit <a href="https://github.com/apereo/cas-server-security-filter">this guide</a>.</p>
<h3>
<a id="spring-webflow-sessions" class="anchor" href="#spring-webflow-sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Spring Webflow Sessions</h3>
<p>The CAS project uses Spring Webflow to manage and orchestrate the authentication process. The conversational state of the<br>
webflow used by CAS is managed by the client which is then passed and tracked throughout various states of the authentication<br>
process. This state must be secured and encrypted to prevent session hijacking. While CAS provides default encryption<br>
settings out of the box, it is <strong>STRONGLY</strong> recommended that <a href="../webflow/Webflow-Customization.html">all CAS deployments</a> be<br>
evaluated prior to production deployments and regenerate this configuration to prevent attacks.</p>
<h3>
<a id="long-term-authentication" class="anchor" href="#long-term-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Long Term Authentication</h3>
<p>The long term authentication feature, commonly referred to as "Remember Me", is selected (usually via checkbox) on the CAS login<br>
form to avoid re-authentication for an extended period of time. Long term authentication allows users to elect additional convenience at<br>
the expense of reduced security. The extent of reduced security is a function of the characteristics of the device used to establish<br>
a CAS SSO session. A long-term SSO session established from a device owned or operated by a single user is marginally less secure than<br>
a standard CAS SSO session. The only real concern would be the increased lifetime and resulting increased exposure of the<br>
CAS ticket-granting ticket. Establishing a long-term CAS SSO session from a shared device, on the other hand, may dramatically reduce security.<br>
The likelihood of artifacts from previous SSO sessions affecting subsequent SSO sessions established by other users, even in the face<br>
of single sign-out, may increase the likelihood of impersonation. While there is no feasible mitigation for improving security<br>
of long-term SSO sessions on a shared device, educating users on the inherent risks may improve overall security.</p>
<p>It is important to note that forced authentication supersedes long term authentication, thus if a service were<br>
configured for forced authentication, authentication would be required for service access even in the context of a<br>
long-term session.</p>
<p>Long term authentication support must be explicitly enabled through<br>
<a href="../installation/Configuring-Authentication-Components.html#long-term-authentication">configuration and UI customization</a><br>
during the installation process. Thus deployers choose to offer long-term authentication support, and when available<br>
users may elect to use it via selection on the CAS login form.</p>
<h3>
<a id="warn" class="anchor" href="#warn" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Warn</h3>
<p>CAS supports optional notification of service access during an established SSO session. By default CAS<br>
transparently requests tickets needed for service access and presents them to the target service for validation,<br>
whereby upon successful validation access to the service is permitted. In most cases this happens nearly instantly<br>
and the user is not aware of the CAS authentication process required to access CAS-enabled services. There may be<br>
some security benefit to awareness of this process, and CAS supports a <em>warn</em> flag that may be selected by the user<br>
on the CAS login screen to provide an interstitial notification page that is displayed prior to accessing a service.<br>
By default the notification page offers the user an option to proceed with CAS authentication or abort by<br>
navigating away from the target service.</p>